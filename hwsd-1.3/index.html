<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>hwsd: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">hwsd
   &#160;<span id="projectnumber">1.3.0</span>
   </div>
   <div id="projectbrief">Local and remote ZeroConf service discovery for hardware resources</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">hwsd Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#hwsd">Hardware Service Discovery</a><ul><li class="level2"><a href="#Modules">Modules</a></li>
<li class="level2"><a href="#VirtualGL">VirtualGL</a></li>
<li class="level2"><a href="#Daemon">Announcement Daemon</a></li>
<li class="level2"><a href="#Build">Building from Source</a></li>
<li class="level2"><a href="#Bugs">Bugs</a></li>
<li class="level2"><a href="#Usage">Usage</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="hwsd"></a>
Hardware Service Discovery</h1>
<p>HW-SD is a library and daemon for the discovery and announcement of hardware resources using ZeroConf. It enables auto-configuration of ad-hoc GPU clusters and multi-GPU machines.</p>
<p>The source code is hosted on <a href="https://github.com/Eyescale/hwsd">github</a> and documented on <a href="https://eyescale.github.io/#hwsd">eyescale.github.io</a>.</p>
<h2><a class="anchor" id="Modules"></a>
Modules</h2>
<p>The HW-SD library uses modules which implement discovery using different protocols. Each module is a separate library, which can be selectively linked by applications to limit dependencies. Currently available are:</p>
<ul>
<li>gpu_dns_sd: Remote ZeroConf (Bonjour) discovery for GPUs announced by the daemon</li>
<li>gpu_cgl: Local discovery of Carbon displays (Mac OS X only)</li>
<li>gpu_glx: Local discovery of X11 servers and screens</li>
<li>gpu_wgl: Local discovery of WGL_NV_gpu_affinity, WGL_AMD_gpu_association or Windows displays (Windows only)</li>
<li>net_dns_sd: Remote ZeroConf (Bonjour) discovery for network interfaces announced by the daemon</li>
<li>net_sys: Local discovery of network interfaces</li>
</ul>
<h2><a class="anchor" id="VirtualGL"></a>
VirtualGL</h2>
<p>When an application is run through VirtualGL, hwsd detects this and sets the FLAG_VIRTUALGL on all local GPUs, and additionally FLAG_VIRTUALGL_DISPLAY on the GPU used by VirtualGL for redirection. This is only implemented for GLX so far (<a href="https://github.com/Eyescale/Equalizer/issues/67">more info</a>).</p>
<h2><a class="anchor" id="Daemon"></a>
Announcement Daemon</h2>
<p>The daemon uses all available local modules to query local GPUs and network interfaces to announce them using ZeroConf to the local network. The service type name is "_gpu-sd" and "_net-sd". The dns_sd discovery module gathers the information announced by all daemons on the local network. The following protocol is used by the daemon:</p>
<ul>
<li>Session=default | &lt;string&gt;</li>
<li>NodeID=&lt;UUID&gt;</li>
<li>Hostname=&lt;string&gt; // optional, hostname for connections</li>
<li>GPU Count=&lt;integer&gt;</li>
<li>GPU&lt;integer&gt; Type=GLX | WGL | WGLn | WGLa | CGL</li>
<li>GPU&lt;integer&gt; Port=&lt;integer&gt; // X11 display number, 0 otherwise</li>
<li>GPU&lt;integer&gt; Device=&lt;integer&gt; // X11 screen number, wglEnumGpusNV index, CGDirectDisplayID</li>
<li>GPU&lt;integer&gt; Width=&lt;integer&gt;</li>
<li>GPU&lt;integer&gt; Height=&lt;integer&gt;</li>
<li>GPU&lt;integer&gt; X=&lt;integer&gt;</li>
<li>GPU&lt;integer&gt; Y=&lt;integer&gt;</li>
<li>GPU&lt;integer&gt; Flags=&lt;integer&gt; // optional flags (see <a class="el" href="gpu_info_8h_source.html">gpuInfo.h</a>)</li>
<li>Net Count=&lt;integer&gt;</li>
<li>Net&lt;integer&gt; Type=TYPE_ETHERNET | TYPE_INFINIBAND | TYPE_LOOPBACK | TYPE_UNKNOWN</li>
<li>Net&lt;integer&gt; Name=&lt;string&gt;</li>
<li>Net&lt;integer&gt; Hostname=&lt;string&gt;</li>
<li>Net&lt;integer&gt; MAC=&lt;string&gt; // ':' as separator</li>
<li>Net&lt;integer&gt; IPv4=&lt;string&gt; // ':' as separator</li>
<li>Net&lt;integer&gt; IPv6=&lt;string&gt; // ':' as separator</li>
<li>Net&lt;integer&gt; Linkspeed=&lt;integer&gt; // in Megabits per second</li>
<li>Net&lt;integer&gt; Up=&lt;bool&gt;</li>
</ul>
<h2><a class="anchor" id="Build"></a>
Building from Source</h2>
<p>HWSD is a cross-platform library, designed to run on any modern operating system, including all Unix variants and the Windows operating system. Zeroconf support in Lunchbox is required for the DNS_SD module and applications. The following platforms and build environments are tested:</p>
<ul>
<li>Linux: Ubuntu 14.04, RHEL 6.6 (Makefile, i386, x64)</li>
<li>Windows: 7 (Visual Studio 2008, i386, x64)</li>
<li>Mac OS X: 10.8 (Makefile, i386, x64)</li>
</ul>
<p>The build system is using CMake, with the standard CMake build process: </p><pre class="fragment">git clone https://github.com/Eyescale/hwsd.git
mkdir hwsd/build
cd hwsd/build
cmake ..
make
</pre><p>A ZeroConf implementation is required for the dns_sd module and the daemon. On Mac OS X it is part of the operating system, on Linux AVAHI is tested ('sudo apt-get install libavahi-compat-libdnssd-dev' on Ubuntu), on Windows use the <a href="https://developer.apple.com/downloads/index.action?q=Bonjour%20SDK%20for%20Windows">Bonjour SDK</a>. If no ZeroConf implementation is found, HW-SD is only compiled with local discovery modules.</p>
<h2><a class="anchor" id="Bugs"></a>
Bugs</h2>
<p>Please file a <a href="https://github.com/Eyescale/hwsd/issues">Bug Report</a> if you find any issue with this software.</p>
<h2><a class="anchor" id="Usage"></a>
Usage</h2>
<p>An application can use the discovery by linking the relevant module libraries, instantiating the modules in the code and then quering the instantiated modules. The following will find all remote and local GPUs and local network interfaces on Windows: </p><pre class="fragment">#include &lt;hwsd/hwsd.h&gt;

hwsd::gpu::wgl::Module::use();
hwsd::gpu::dns_sd::Module::use();
const hwsd::GPUInfos&amp; gpus = hwsd::discoverGPUInfos();

hwsd::net::sys::Module::use();
const hwsd::NetInfos&amp; nets = hwsd::discoverNetInfos();
</pre><p>Filters are chainable functors which can be passed to the query function to discard information. The following filters are provided:</p>
<ul>
<li>DuplicateFilter eliminates duplicates, e.g., when one announcement is seen on multiple interfaces</li>
<li>MirrorFilter eliminates the same GPU with a different type, e.g., when enabling both the cgl and glx module on Mac OS X.</li>
<li>SessionFilter discards all resources not belonging to a given session </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jun 1 2016 15:38:58 for hwsd by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
